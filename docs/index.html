<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R–Ratepol: Estimating Rate of Change in Temporal Sequences • RRatepol</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="R–Ratepol: Estimating Rate of Change in Temporal Sequences">
<meta property="og:description" content="R-Ratepol is an R package for estimating rate of change (RoC) from community data in time series.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">RRatepol</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="divider">
    <li class="dropdown-header">vignettes</li>
    <li>
      <a href="articles/workflow-example.html">Example of full workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="r-ratepol-package" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#r-ratepol-package" class="anchor"></a>R-Ratepol package</h1></div>
<div id="current-version-061" class="section level2">
<h2 class="hasAnchor">
<a href="#current-version-061" class="anchor"></a>Current version: 0.6.1.</h2>
<p>What is new in the package? See <a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/blob/master/NEWS.md">NEWS</a></p>
</div>
<div id="description" class="section level2">
<h2 class="hasAnchor">
<a href="#description" class="anchor"></a>Description</h2>
<p>R-Ratepol is an R package for estimating rate of change (RoC) from community data in time series.</p>
<p>Reference: Ondřej Mottl, John-Arvid Grytnes, Alistair W.R. Seddon, Manuel J. Steinbauer, Kuber P. Bhatta, Vivian A. Felde, Suzette G.A. Flantua, H. John B. Birks. (2021) Rate-of-change analysis in palaeoecology revisited: a new approach. Review of Palaeobotany and Palynology 293, doi:</p>
<p><a href="https://doi.org/10.1016/j.revpalbo.2021.104483" class="uri">https://doi.org/10.1016/j.revpalbo.2021.104483</a></p>
<p>R-Ratepol is written as an R package and includes a range of possible settings including a novel method to evaluate RoC in a single stratigraphical sequence using assemblage data and age uncertainties for each level. There are multiple built-in dissimilarity coefficients (DC) for different types of assemblage data, and various levels of data smoothing that can be applied depending on the type and variance of the data. In addition, R-Ratepol can use randomisation, accompanied by use of age uncertainties of each level and taxon standardisation to detect RoC patterns in datasets with high data noise or variability (i.e. numerous rapid changes in composition or sedimentation rates).</p>
<p>The computation of RoC in R-Ratepol is performed using the following steps:</p>
<ol>
<li><p>Assemblage and age-model data are extracted from the original source and should be compiled together, i.e. depth, age, variable (taxon) 1, variable (taxon) 2, etc.</p></li>
<li><p>(optional) Smoothing of assemblage data: Each variable within the assemblage data is smoothed using one of five in-built smoothing methods: none (<code>smooth_method = "none"</code>), Shepard’s 5-term filter (<code>smooth_method = "shep"</code>; Davis, 1986; Wilkinson, 2005), moving average (<code>smooth_method = "m.avg"</code>), age-weighted average (<code>smooth_method = "age.w"</code>), Grimm’s smoothing (<code>smooth_method = "grim"</code>; Grimm and Jacobson, 1992).</p></li>
<li><p>Creation of time bins: A template for all time bins in all window movements is created.</p></li>
<li><p>A single run (an individual loop) is computed:</p></li>
</ol>
<ul>
<li><p>(optional) Selection of one time series from age uncertainties (see section 2.1.1.2. on randomisation)</p></li>
<li><p>Subsetting levels in each bin: Here the working units (WU) are defined</p></li>
<li><p>(optional) Standardisation of assemblage data in each WU</p></li>
<li><p>Calculation of RoC between WUs: RoC is calculated as the dissimilarity coefficient (DC) standardised by age differences between WUs. Several in-built dissimilarity coefficients are available: Euclidean distance (<code>DC = "euc</code>), standardised Euclidean distance (<code>DC = "euc.sd</code>), Chord distance (<code>DC = "chord</code>), Chi-squared coefficient (<code>DC = "chisq</code>; Prentice, 1980), Gower’s distance (<code>DC = "gower</code>; Gower, 1971), Bray-Curtis(<code>DC = "bray</code>). The choice of DC depends on the type of assemblage data. In addition, RoC between WUs be calculated using every consecutive WU (<code>only_subsequent = FALSE</code>), or alternatively, calculation of RoC can be restricted to only directly adjacent WUs (<code>only_subsequent = TRUE</code>). Using the former increases the number of samples for which RoC can be calculated within a sequence, which varies in terms of sample resolution, but may still introduce biases related to the RoC estimation as a result of the varying inter-sample distances.</p></li>
<li><p>The summary of a single run is produced based on all moving windows</p></li>
</ul>
<ol>
<li><p>Step 4 is repeated multiple times (e.g. 10,000 times).</p></li>
<li><p>Validation and summary of results from all runs of RoC calculation are produced.</p></li>
<li><p>(Optional) Data beyond a certain age can be excluded.</p></li>
<li><p>Detection and validation of significant peak-points. There are five in-built methods to detect significant peak-points: Threshold (<code>method = "threshold</code>), Linear trend (<code>method = "trend_linear</code>), Non-linear trend (<code>method = "trend_non_linear</code>), first derivative of a generalised additive model (<code>method = "GAM_deriv</code>; f-deriv GAM; Simpson, 2018), and Signal-to-Noise Index (<code>method = "SNI</code>; Kelly et al., 2011).</p></li>
</ol>
</div>
<div id="selection-of-working-units" class="section level2">
<h2 class="hasAnchor">
<a href="#selection-of-working-units" class="anchor"></a>Selection of working units</h2>
<p>RoC is calculated between consecutive Working Units (WU). Traditionally, these WUs represent individual stratigraphical levels. However, changes in sedimentation rates and sampling strategies can result in an uneven temporal distribution of levels within a time sequence, which in turn makes the comparison of RoC between sequences problematic. There are various methods that attempt to minimise such problems. The first is interpolation of levels to evenly spaced time intervals, and the use of the interpolated data as WUs. This can lead to a loss of information when the density of levels is high. Second is binning of levels: assemblage data are pooled into age brackets of various size (i.e. time bins) and these serve as WUs. Here, the issue is a lower resolution of WUs and their uneven size in terms of total assemblage count (bins with more levels have higher assemblage counts). Third is selective binning: like classical binning, bins of selected size are created, but instead of pooling assemblage data together, only one level per time bin is selected as representative of each bin. This results in an even number of WUs in bins with a similar count size in the assemblage. However, the issue of low resolution remains. Therefore, we propose a new method of binning with a moving window, which is a compromise between using individual levels and selective binning. This method follows a simple sequence: time bins are created, levels are selected as in selective binning, and RoC between bins is calculated. However, the brackets of the time bin (window) are then moved forward by a selected amount of time (Z), levels are selected again (subset into bins), and RoC calculated for the new set of WUs. This is repeated X times (where X is the bin size divided by Z) while retaining all the results. R-Ratepol currently provides several options for selecting WU, namely as individual levels (<code>Working_Units = "levels"</code>), selective binning of levels (<code>Working_Units = "bins"</code>), and our new method of binning with a moving window (<code>Working_Units = "MW"</code>), which is summarised in figure.</p>
<p><img src="reference/figures/Fig_Scheme.png"></p>
</div>
<div id="randomisation" class="section level2">
<h2 class="hasAnchor">
<a href="#randomisation" class="anchor"></a>Randomisation</h2>
<p>Due to the inherent statistical errors in uncertainties in the age estimates from age-depth and the assemblage datasets (e.g. pollen counts in each level; Birks and Gordon, 1985), R-Ratepol can be run several times and the results summarised (Steps 5-6). Therefore, two optional settings are available by using age uncertainties and assemblage data standardisation.</p>
<div id="age-uncertainties-step-4a" class="section level3">
<h3 class="hasAnchor">
<a href="#age-uncertainties-step-4a" class="anchor"></a>Age uncertainties (Step 4a)</h3>
<p>For each run, a single age sequence from the age uncertainties is randomly selected. The calculation between two consecutive WUs (i.e. one working-unit combination) results in a RoC score and a time position (which is calculated as the mean age position of the two WUs). However, due to random sampling of the age sequence, each WU combination will result in multiple RoC values. The final RoC value for a single WU combination is calculated as the median of the scores from all randomisations. In addition, the 95th quantile from all randomisations is calculated as an error estimate.</p>
</div>
<div id="data-standardisation-step-4b" class="section level3">
<h3 class="hasAnchor">
<a href="#data-standardisation-step-4b" class="anchor"></a>Data standardisation (Step 4b)</h3>
<p>Variables (taxa) in the assemblage dataset can be standardised to a certain count (e.g. number of pollen grains in each WU) by rarefaction. Random sampling without replacement is used to draw a selected number of individuals from each WU (e.g. 150 pollen grains).</p>
</div>
</div>
<div id="detection-of-peak-points-in-roc-sequence-step-8" class="section level2">
<h2 class="hasAnchor">
<a href="#detection-of-peak-points-in-roc-sequence-step-8" class="anchor"></a>Detection of peak-points in RoC sequence (Step 8)</h2>
<p>A rapid change in composition or relative abundances of variables within the sequence can provide a means of comparing RoC between sequences and interpreting the potential drivers of assemblage change. To detect such significant peak-points of RoC scores in each sequence, each point is tested to see if it represents a significant increase in RoC values. There are various ways to detect peak-points in a time series and R-Ratepol is able to detect peak-points using five methods:</p>
<ul>
<li><p>Threshold (<code>method = "threshold</code>): Each point in the RoC sequence is compared to a median of all RoC scores from the whole sequence (i.e. threshold value). The ROC value for a point is considered significant if the 95th quantile of the RoC scores from all calculations is higher than the threshold value.</p></li>
<li><p>Linear trend (<code>method = "trend_linear</code>): A linear model is fitted between the RoC values and their ages. Differences between the model and each point are calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (<code>sd_threshold = 1.5</code>).</p></li>
<li><p>Non-linear trend (<code>method = "trend_non_linear</code>): A conservative generalised additive model (GAM) is fitted through the RoC scores and their ages (GAM= RoC ~ s(age,k=3) using the mgcv package (Wood, 2011). The distance between each point and the fitted value is calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (<code>sd_threshold = 1.5</code>).</p></li>
<li><p>F-deriv GAM (<code>method = "GAM_deriv</code>): A smooth GAM model is fitted to the RoC scores and their ages (GAM= RoC ~ s(age). The first derivative as well as continuous confidence intervals are calculated from the model using the gratia package (Simpson, 2019). A peak is considered significant if the confidence intervals of the first derivative differ from 0 (for more information see Simpson, 2018).</p></li>
<li><p>Signal-to-noise method (<code>method = "SNI</code>): We adapted SNI from Kelly et al. (2011), which was developed to detect changes in charcoal stratigraphical records. SNI is calculated for the whole RoC sequence and a peak-point is considered significant if it has an SNI value higher than 3.</p></li>
</ul>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>For more detailed example, see <a href="https://github.com/OndrejMottl/palaeoR_R-Ratepol_workshop">Materials for Seminar Day of PalaeoSIG: Data Manipulation &amp; Statistical Analysis in Palaeoecology</a></p>
<div id="instaling-package" class="section level3">
<h3 class="hasAnchor">
<a href="#instaling-package" class="anchor"></a>Instaling package</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"HOPE-UIB-BIO/R-Ratepol-package"</span>)</span></code></pre></div>
</div>
<div id="example-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h3>
<p>Pollen data from four European sequences the <em>Neotoma database</em> (Goring et al., 2015) were obtained. Taxa were standardised to the taxonomically highest pollen morphotype (Level = MHVar2) using the pollen harmonisation table in Giesecke et al. (2019).</p>
<p>Age-depth models were developed using the pre-selected radiometric control points provided in Giesecke et al. (2014) and calibrated the radiocarbon dates using the IntCal13 Northern Hemisphere calibration curve (Reimer et al., 2013). For each sequence, an age-depth model was constructed using the <em>Bchron R package</em> (Haslett &amp; Parnell, 2008) to generate 1000 possible age predictions (i.e. age uncertainties) for all levels. We calculated the median of all the uncertainties for each level to give the most probable age (default age) in calibrated years before present (cal yr BP, where 0 = 1950 CE).</p>
<p>In each sequence, we excluded all levels that contained less than 150 pollen grain counts of the terrestrial taxa, and all levels beyond a 3000-years extrapolation of the oldest chronological control point. In addition, we excluded all levels with an age older than 8500 cal yr BP to focus on the period of most substantial human impact.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(RRatepol)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb2-3"><a href="#cb2-3"></a></span>
<span id="cb2-4"><a href="#cb2-4"></a>example_data &lt;-<span class="st">  </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="st">  </span>RRatepol<span class="op">::</span>example_data</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw">glimpse</span>(example_data)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; Rows: 4</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; Columns: 7</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt; $ dataset.id        &lt;chr&gt; "4012", "40951", "45314", "17334"</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; $ collection.handle &lt;chr&gt; "DALLICAN", "STEERMOS", "KILOALA", "GL"</span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; $ lat               &lt;dbl&gt; 60.38736, 47.80567, 67.96611, 53.00735</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; $ long              &lt;dbl&gt; -1.096480, 8.200150, 20.460278, -6.348035</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; $ pollen_data       &lt;list&gt; [&lt;tbl_df[63 x 51]&gt;], [&lt;tbl_df[273 x 104]&gt;], [&lt;tbl_df~</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; $ sample_age        &lt;named list&gt; [&lt;data.frame[63 x 3]&gt;], [&lt;data.frame[273 x 3]&gt;], [&lt;d~</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; $ age_uncertainty   &lt;named list&gt; &lt;&lt;matrix[1000 x 63]&gt;&gt;, &lt;&lt;matrix[1000 x 273]&gt;&gt;, &lt;&lt;mat~</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a>example_data <span class="op">%&gt;%</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw">ggplot</span>(</span>
<span id="cb2-20"><a href="#cb2-20"></a>    ggplot2<span class="op">::</span><span class="kw">aes</span>(</span>
<span id="cb2-21"><a href="#cb2-21"></a>      <span class="dt">x =</span> long,</span>
<span id="cb2-22"><a href="#cb2-22"></a>      <span class="dt">y =</span> lat)) <span class="op">+</span></span>
<span id="cb2-23"><a href="#cb2-23"></a><span class="st">  </span><span class="kw">borders</span>(</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="dt">fill =</span> <span class="st">"gray90"</span>,</span>
<span id="cb2-25"><a href="#cb2-25"></a>    <span class="dt">colour =</span> <span class="ot">NA</span>) <span class="op">+</span></span>
<span id="cb2-26"><a href="#cb2-26"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb2-27"><a href="#cb2-27"></a>    <span class="dt">shape =</span> <span class="dv">0</span>,</span>
<span id="cb2-28"><a href="#cb2-28"></a>    <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="st">  </span><span class="kw">geom_point</span>(</span>
<span id="cb2-30"><a href="#cb2-30"></a>    <span class="dt">shape =</span> <span class="dv">20</span>,</span>
<span id="cb2-31"><a href="#cb2-31"></a>    <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="st">  </span><span class="kw">coord_quickmap</span>(</span>
<span id="cb2-33"><a href="#cb2-33"></a>    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">25</span>),</span>
<span id="cb2-34"><a href="#cb2-34"></a>    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">47</span>, <span class="dv">70</span>)) <span class="op">+</span></span>
<span id="cb2-35"><a href="#cb2-35"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb2-36"><a href="#cb2-36"></a>    <span class="dt">x =</span> <span class="st">"Longitude"</span>,</span>
<span id="cb2-37"><a href="#cb2-37"></a>    <span class="dt">y =</span> <span class="st">"Latitude"</span>) <span class="op">+</span></span>
<span id="cb2-38"><a href="#cb2-38"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
<p><img src="reference/figures/README-plot_data-1.png"></p>
</div>
<div id="example-1" class="section level3">
<h3 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example 1</h3>
<p>Estimate RoC values for <em>Dallican Water</em> site using <em>Age-weighed smoothing</em> of the data and <em>Chord dissimilarity</em> coefficient. Pollen data will not standardised to a certain pollen count and age uncertainties from <em>Bchron</em> will not be used.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>sequence_<span class="dv">01</span> &lt;-<span class="st"> </span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="st">  </span>RRatepol<span class="op">::</span><span class="kw">fc_estimate_RoC</span>(</span>
<span id="cb3-3"><a href="#cb3-3"></a>    <span class="dt">data_source_community =</span> example_data<span class="op">$</span>pollen_data[[<span class="dv">1</span>]],</span>
<span id="cb3-4"><a href="#cb3-4"></a>    <span class="dt">data_source_age =</span> example_data<span class="op">$</span>sample_age[[<span class="dv">1</span>]],</span>
<span id="cb3-5"><a href="#cb3-5"></a>    <span class="dt">age_uncertainty =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-6"><a href="#cb3-6"></a>    <span class="dt">smooth_method =</span> <span class="st">"shep"</span>,</span>
<span id="cb3-7"><a href="#cb3-7"></a>    <span class="dt">DC =</span> <span class="st">"chisq"</span>,</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="dt">Working_Units =</span> <span class="st">"levels"</span>,</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="dt">standardise =</span> <span class="ot">FALSE</span>,</span>
<span id="cb3-10"><a href="#cb3-10"></a>    <span class="dt">rand =</span> <span class="dv">1</span>)</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a>RRatepol<span class="op">::</span><span class="kw">fc_plot_RoC_sequence</span>(sequence_<span class="dv">01</span>, <span class="dt">Peaks =</span> F, <span class="dt">trend =</span> F)</span></code></pre></div>
<p><img src="reference/figures/README-plot_1-1.png"></p>
</div>
<div id="example-2" class="section level3">
<h3 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example 2</h3>
<p>Now try to standardise pollen data in each sample to a maximum of 150 pollen grains and use age uncertainties from <em>age-depth model</em>. Process will be repeated 1000 times on multiple cores using <em>parallel package</em>. This will produce error <em>wrapper</em> showing 95th percent quantile.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>sequence_<span class="dv">02</span> &lt;-</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span>RRatepol<span class="op">::</span><span class="kw">fc_estimate_RoC</span>(</span>
<span id="cb4-3"><a href="#cb4-3"></a>    <span class="dt">data_source_community =</span> example_data<span class="op">$</span>pollen_data[[<span class="dv">1</span>]],</span>
<span id="cb4-4"><a href="#cb4-4"></a>    <span class="dt">data_source_age =</span> example_data<span class="op">$</span>sample_age[[<span class="dv">1</span>]],</span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="dt">age_uncertainty =</span> example_data<span class="op">$</span>age_uncertainty[[<span class="dv">1</span>]],</span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="dt">smooth_method =</span> <span class="st">"shep"</span>,</span>
<span id="cb4-7"><a href="#cb4-7"></a>    <span class="dt">DC =</span> <span class="st">"chisq"</span>,</span>
<span id="cb4-8"><a href="#cb4-8"></a>    <span class="dt">Working_Units =</span> <span class="st">"levels"</span>,</span>
<span id="cb4-9"><a href="#cb4-9"></a>    <span class="dt">standardise =</span> <span class="ot">TRUE</span>,</span>
<span id="cb4-10"><a href="#cb4-10"></a>    <span class="dt">N_individuals =</span> <span class="dv">150</span>,</span>
<span id="cb4-11"><a href="#cb4-11"></a>    <span class="dt">rand =</span> <span class="dv">1000</span>,</span>
<span id="cb4-12"><a href="#cb4-12"></a>    <span class="dt">treads =</span> <span class="ot">TRUE</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a></span>
<span id="cb4-14"><a href="#cb4-14"></a>RRatepol<span class="op">::</span><span class="kw">fc_plot_RoC_sequence</span>(</span>
<span id="cb4-15"><a href="#cb4-15"></a>  <span class="dt">data_source =</span> sequence_<span class="dv">02</span>,</span>
<span id="cb4-16"><a href="#cb4-16"></a>  <span class="dt">Peaks =</span> <span class="ot">FALSE</span>,</span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="dt">trend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="reference/figures/README-plot_2-1.png"></p>
</div>
<div id="example-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example 3</h3>
<p>Use <em>Binning with the mowing window</em> approach with <code>bin_size</code> = 500 and <code>Number_of_shifts</code> = 5.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>sequence_<span class="dv">03</span> &lt;-</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">    </span>RRatepol<span class="op">::</span><span class="kw">fc_estimate_RoC</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="dt">data_source_community =</span> example_data<span class="op">$</span>pollen_data[[<span class="dv">1</span>]],</span>
<span id="cb5-4"><a href="#cb5-4"></a>    <span class="dt">data_source_age =</span> example_data<span class="op">$</span>sample_age[[<span class="dv">1</span>]],</span>
<span id="cb5-5"><a href="#cb5-5"></a>    <span class="dt">age_uncertainty =</span> example_data<span class="op">$</span>age_uncertainty[[<span class="dv">1</span>]],</span>
<span id="cb5-6"><a href="#cb5-6"></a>    <span class="dt">smooth_method =</span> <span class="st">"shep"</span>,</span>
<span id="cb5-7"><a href="#cb5-7"></a>    <span class="dt">DC =</span> <span class="st">"chisq"</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>    <span class="dt">Working_Units =</span> <span class="st">"MW"</span>,</span>
<span id="cb5-9"><a href="#cb5-9"></a>    <span class="dt">bin_size =</span> <span class="dv">500</span>,</span>
<span id="cb5-10"><a href="#cb5-10"></a>    <span class="dt">Number_of_shifts  =</span> <span class="dv">5</span>,</span>
<span id="cb5-11"><a href="#cb5-11"></a>    <span class="dt">standardise =</span> <span class="ot">TRUE</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>    <span class="dt">N_individuals =</span> <span class="dv">150</span>,</span>
<span id="cb5-13"><a href="#cb5-13"></a>    <span class="dt">rand =</span> <span class="dv">1000</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="dt">treads =</span> <span class="ot">TRUE</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a>RRatepol<span class="op">::</span><span class="kw">fc_plot_RoC_sequence</span>(</span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="dt">data_source =</span> sequence_<span class="dv">03</span>,</span>
<span id="cb5-18"><a href="#cb5-18"></a>  <span class="dt">Peaks =</span> <span class="ot">FALSE</span>,</span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="dt">trend =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="reference/figures/README-plot_3-1.png"></p>
</div>
<div id="example-4" class="section level3">
<h3 class="hasAnchor">
<a href="#example-4" class="anchor"></a>Example 4</h3>
<p>Detect the <em>peak points</em> using <em>trend_non_linear</em> method.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>sequence_<span class="dv">03</span>_peaks &lt;-</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  </span>RRatepol<span class="op">::</span><span class="kw">fc_detect_peak_points</span>(</span>
<span id="cb6-3"><a href="#cb6-3"></a>    <span class="dt">data_source =</span> sequence_<span class="dv">03</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>    <span class="dt">method =</span> <span class="st">"trend_non_linear"</span>)</span>
<span id="cb6-5"><a href="#cb6-5"></a></span>
<span id="cb6-6"><a href="#cb6-6"></a>RRatepol<span class="op">::</span><span class="kw">fc_plot_RoC_sequence</span>(</span>
<span id="cb6-7"><a href="#cb6-7"></a>  <span class="dt">data_source =</span> sequence_<span class="dv">03</span>_peaks,</span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="dt">Peaks =</span> <span class="ot">TRUE</span>,</span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="dt">trend =</span> <span class="st">"trend_non_linear"</span>)</span></code></pre></div>
<p><img src="reference/figures/README-plot_4-1.png"></p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Birks, H.J.B., Gordon, A.D., 1985. Numerical Methods in Quaternary Pollen Analysis. Academic Press, London.</p>
<p>Davis, J.C., 1986. Statistics and Data Analysis in Geology, 2nd edn. ed. J. Wiley &amp; Sons, New York.</p>
<p>Gower, J.C., 1971. A general coefficient of similarity and some of its properties. Biometrics 27, 857–871.</p>
<p>Grimm, E.C., Jacobson, G.L., 1992. Fossil-pollen evidence for abrupt climate changes during the past 18000 years in eastern North America. Clim. Dyn. 6, 179–184.</p>
<p>Kelly, R.F., Higuera, P.E., Barrett, C.M., Feng Sheng, H., 2011. A signal-to-noise index to quantify the potential for peak detection in sediment-charcoal records. Quat. Res. 75, 11–17. <a href="https://doi.org/10.1016/j.yqres.2010.07.011" class="uri">https://doi.org/10.1016/j.yqres.2010.07.011</a></p>
<p>Prentice, I.C., 1980. Multidimensional scaling as a research tool in Quaternary palynology: A review of theory and methods. Rev. Palaeobot. Palynol. 31, 71–104. <a href="https://doi.org/10.1016/0034-6667(80)90023-8" class="uri">https://doi.org/10.1016/0034-6667(80)90023-8</a></p>
<p>Simpson, G.L., 2019. gratia: graceful’ggplot’–based graphics and other functions for GAMs fitted using “mgcv.” R Packag. version 0.2–1.</p>
<p>Simpson, G.L., 2018. Modelling palaeoecological time series using generalised additive models. Front. Ecol. Evol. 6, 1–21. <a href="https://doi.org/10.3389/fevo.2018.00149" class="uri">https://doi.org/10.3389/fevo.2018.00149</a></p>
<p>Wilkinson, L., 2005. The Grammar of Graphics. Springer-Verlag, New York, USA 37. <a href="https://doi.org/10.2307/2669493" class="uri">https://doi.org/10.2307/2669493</a> Wood, S.N., 2011. Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. J. R. Stat. Soc. Ser. B Stat. Methodol. 73, 3–36. <a href="https://doi.org/10.1111/j.1467-9868.2010.00749.x" class="uri">https://doi.org/10.1111/j.1467-9868.2010.00749.x</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing RRatepol</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Ondrej Mottl <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Ondrej Mottl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
