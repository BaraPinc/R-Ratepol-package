<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Detect significant peak points — fc_detect_peak_points • RRatepol</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Detect significant peak points — fc_detect_peak_points" />
<meta property="og:description" content="Detect points of sudden increae of Rate-of-change values" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RRatepol</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">vignettes</li>
    <li>
      <a href="../articles/workflow-example.html">Example of full workflow</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Detect significant peak points</h1>
    
    <div class="hidden name"><code>fc_detect_peak_points.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Detect points of sudden increae of Rate-of-change values</p>
    </div>

    <pre class="usage"><span class='fu'>fc_detect_peak_points</span><span class='op'>(</span><span class='va'>data_source</span>, method <span class='op'>=</span> <span class='st'>"trend_linear"</span>, sd_threshold <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data_source</th>
      <td><p>data from fc_estimate_RoC function.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method of peak detection:</p>  
<p><code>"threshold"</code>         = Each point in the RoC sequence is compared to a median of all RoC scores from the whole sequence (i.e. threshold value). The ROC value for a point is considered significant if the 95th quantile of the RoC scores from all calculations is higher than the threshold value.</p>
<p><code>"trend_linear"</code>      = A linear model is fitted between the RoC values and their ages. Differences between the model and each point are calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (`sd_threshold = 1.5`).</p>  
<p><code>"trend_non_linear"</code>  = A conservative generalised additive model (GAM) is fitted through the RoC scores and their ages (GAM= RoC ~ s(age,k=3) using the mgcv package (Wood, 2011). The distance between each point and the fitted value is calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (`sd_threshold = 1.5`).</p>            
<p><code>"GAM_deriv"</code>         = A smooth GAM model is fitted to the RoC scores and their ages (GAM= RoC ~ s(age). The first derivative as well as continuous confidence intervals are calculated from the model using the gratia package (Simpson, 2019). A peak is considered significant if the confidence intervals of the first derivative differ from 0 (for more information see Simpson, 2018).</p>
<p><code>"SNI"</code>              = We adapted SNI from Kelly et al. (2011), which was developed to detect changes in charcoal stratigraphical records. SNI is calculated for the whole RoC sequence and a peak-point is considered significant if it has an SNI value higher than 3.</p></td>
    </tr>
    <tr>
      <th>sd_threshold</th>
      <td><p>Threshold that SD of residuals are compared to, to determine peak-point (default = 1.5).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>A rapid change in composition or relative abundances of variables within the sequence can provide a means of comparing RoC between sequences and interpreting the potential drivers of assemblage change. To detect such significant peak-points of RoC scores in each sequence, each point is tested to see if it represents a significant increase in RoC values. There are various ways to detect peak-points in a time series and R-Ratepol is able to detect peak-points using five methods:</p>
<p>- Threshold (<code>method = "threshold"</code>): Each point in the RoC sequence is compared to a median of all RoC scores from the whole sequence (i.e. threshold value). The ROC value for a point is considered significant if the 95th quantile of the RoC scores from all calculations is higher than the threshold value.</p>
<p>- Linear trend (<code>method = "trend_linear"</code>): A linear model is fitted between the RoC values and their ages. Differences between the model and each point are calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (`sd_threshold = 1.5`).</p>
<p>- Non-linear trend (<code>method = "trend_non_linear"</code>): A conservative generalised additive model (GAM) is fitted through the RoC scores and their ages (GAM = RoC ~ s(age,k=3) using the mgcv package (Wood, 2011). The distance between each point and the fitted value is calculated (residuals). The standard deviation (SD) is calculated from all the residuals. A peak is considered significant if it is 1.5 SD higher than the model (`sd_threshold = 1.5`).</p>
<p>- F-deriv GAM  (<code>method = "GAM_deriv"</code>): A smooth GAM model is fitted to the RoC scores and their ages (GAM= RoC ~ s(age). The first derivative as well as continuous confidence intervals are calculated from the model using the gratia package (Simpson, 2019). A peak is considered significant if the confidence intervals of the first derivative differ from 0 (for more information see Simpson, 2018).</p>
<p>- Signal-to-noise method (<code>method = "SNI"</code>): We adapted SNI from Kelly et al. (2011), which was developed to detect changes in charcoal stratigraphical records. SNI is calculated for the whole RoC sequence and a peak-point is considered significant if it has an SNI value higher than 3.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kelly, R.F., Higuera, P.E., Barrett, C.M., Feng Sheng, H., 2011. A signal-to-noise index to quantify the potential for peak detection in sediment-charcoal records. Quat. Res. 75, 11–17. https://doi.org/10.1016/j.yqres.2010.07.011</p>
<p>Simpson, G.L., 2019. gratia: graceful'ggplot'–based graphics and other functions for GAMs fitted using “mgcv.” R Packag. version 0.2–1.</p>
<p>Simpson, G.L., 2018. Modelling palaeoecological time series using generalised additive models. Front. Ecol. Evol. 6, 1–21. https://doi.org/10.3389/fevo.2018.00149</p>
<p>Wood, S.N., 2011. Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models. J. R. Stat. Soc. Ser. B Stat. Methodol. 73, 3–36. https://doi.org/10.1111/j.1467-9868.2010.00749.x</p>



    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Ondrej Mottl</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'></span>
<span class='r-in'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'><span class='va'>example_data</span> <span class='op'>&lt;-</span>  <span class='fu'>RRatepol</span><span class='fu'>::</span><span class='va'><a href='example_data.html'>example_data</a></span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>sequence_01</span> <span class='op'>&lt;-</span> </span>
<span class='r-in'>  <span class='fu'><a href='fc_estimate_RoC.html'>fc_estimate_RoC</a></span><span class='op'>(</span></span>
<span class='r-in'>    data_source_community <span class='op'>=</span> <span class='va'>example_data</span><span class='op'>$</span><span class='va'>pollen_data</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,</span>
<span class='r-in'>    data_source_age <span class='op'>=</span> <span class='va'>example_data</span><span class='op'>$</span><span class='va'>sample_age</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,</span>
<span class='r-in'>    age_uncertainty <span class='op'>=</span> <span class='cn'>FALSE</span>,</span>
<span class='r-in'>    smooth_method <span class='op'>=</span> <span class='st'>"shep"</span>,</span>
<span class='r-in'>    Working_Units <span class='op'>=</span> <span class='st'>"MW"</span>,</span>
<span class='r-in'>    rand <span class='op'>=</span> <span class='fl'>1e3</span>, </span>
<span class='r-in'>    treads <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>    DC <span class='op'>=</span> <span class='st'>"chisq"</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='va'>sequence_01_peak</span> <span class='op'>&lt;-</span></span>
<span class='r-in'>  <span class='fu'>fc_detect_peak_points</span><span class='op'>(</span><span class='va'>sequence_01</span>, method <span class='op'>=</span> <span class='st'>"trend_non_linear"</span>, sd_threshold <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span></span>
<span class='r-in'>  </span>
<span class='r-in'><span class='fu'><a href='fc_plot_RoC_sequence.html'>fc_plot_RoC_sequence</a></span><span class='op'>(</span></span>
<span class='r-in'>  <span class='va'>sequence_01_peak</span>,</span>
<span class='r-in'>  age_threshold <span class='op'>=</span> <span class='fl'>8e3</span>,</span>
<span class='r-in'>  Roc_threshold <span class='op'>=</span> <span class='fl'>2</span>,</span>
<span class='r-in'>  Peaks <span class='op'>=</span> <span class='cn'>TRUE</span>,</span>
<span class='r-in'>  trend <span class='op'>=</span> <span class='st'>"trend_non_linear"</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span></span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ondrej Mottl.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


